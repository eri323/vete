<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>citas</title>
    <link rel="stylesheet" href="./stylevte2.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
</head>
<body>
    <div id="container">
<button style="margin: 20px 0px;" data-bs-toggle="modal" data-bs-target="#exampleModal" id="boton">Crear
    cita</button>
    <div id="checks">
        <label for=""><input type="checkbox" id="anuladas" class="checkbox" name="check"> Anuladas</label>
        <label for=""><input type="checkbox" id="activas" class="checkbox" name="check">Abiertas</label>
        <label for=""><input type="checkbox" id="anuladas" class="checkbox" name="check">Cerradas</label>
    </div>
    

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Nuevo registro</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                <h4 id="Alerta"></h4>
            </div>
            <div class="modal-body">

                <label for="">Nombre mascota</label><input type="text" id="nombre">

                <label for="">Propietario</label><input type="text" id="propietario">

                <label for="">Telefono</label><input type="number" id="telefono">

                <label for="">Tipo de animal</label>
                <select name="" id="tipo">
                    <option value=""></option>
                    <option value="Gato">Gato</option>
                    <option value="Perro">Perro</option>
                    <option value="Ave">Ave</option>
                    <option value="Pez">Pez</option>
                    <option value="Reptil">Reptil</option>
                </select>

                <label for="">Fecha</label><input type="date" id="fecha">

                <label for="">Hora</label><input type="time" id="hora">

                <label for="">Sintomas</label><textarea name="" id="sinto" cols="30" rows="10"></textarea>

            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button onclick="if(validar()) crear(), limpiar()" type="button" class="btn btn-primary"
                    id="boto">Guardar</button>
            </div>
        </div>
    </div>
</div>
<hr>
<h1 id="citatitle">Citas</h1>
<div id="tarjetas">
    
    <img src="./img1/masco.png" alt="" id="img3">

</div>
<hr>
<a href="./citasvete.html">
    <button id="boton">Volver</button>
</a>
<div id="redes">

</div>
    </div>
    
</body>
<script>

    let checkboxes = document.querySelectorAll('.checkbox');

    checkboxes.forEach(function (checkbox) {
        checkbox.addEventListener('change', function () {
            if (this.checked) {
                checkboxes.forEach(function (otherCheckbox) {
                    if (otherCheckbox !== checkbox) {
                        otherCheckbox.checked = false;
                    }
                });
            }
        });
    });





    let mascotas = [
        {
            gato: "./img1/gato.png",
            perro: "./img1/perro.png",
            ave: "./img1/ave.png",
            pez: "./img1/ave.png",
            reptil: "./img1/reptil.png"
        }

    ];

    function crear() {
        let indiceTarjetaModificada = -1;
        let cardsContainer = document.getElementById("tarjetas");
        let guardar = document.getElementById("boto");
        guardar.setAttribute("onclick", "crear()"); // Agregar el atributo onclick


        for (let i = 0; i < mascotas.length; i++) {
            let mascota = mascotas[i];

            let card = document.createElement("div");
            card.className = "card";
            card.id = "tarjeta-" + i;
            card.style.border = "3px solid rgb(67, 193, 207)";
            card.style.borderRadius = "20px"
            let imagen = document.createElement("img");
            if (document.getElementById("tipo").value == "Gato") {
                imagen.src = mascota.gato;
            } else if (document.getElementById("tipo").value == "Perro") {
                imagen.src = mascota.perro;
            } else if (document.getElementById("tipo").value == "Ave") {
                imagen.src = mascota.ave;
            } else if (document.getElementById("tipo").value == "Pez") {
                imagen.src = mascota.pez;
            } else if (document.getElementById("tipo").value == "Reptil") {
                imagen.src = mascota.reptil;
            }
            let nombre = document.createElement("h2");
            nombre.textContent = document.getElementById("nombre").value;

            let propietario = document.createElement("p");
            propietario.innerHTML = "<strong>Propietario:</strong> " + document.getElementById("propietario").value;

            let telefono = document.createElement("p");
            telefono.innerHTML = "<strong>Teléfono:</strong> " + document.getElementById("telefono").value;

            let fecha = document.createElement("p");
            fecha.innerHTML = "<strong>Fecha:</strong> " + document.getElementById("fecha").value;

            let hora = document.createElement("p");
            hora.innerHTML = "<strong>Hora:</strong> " + document.getElementById("hora").value;

            let tipoSeleccionado = document.getElementById("tipo").value;
            let tipoSeleccionadoElement = document.createElement("p");
            tipoSeleccionadoElement.innerHTML = "<strong>Tipo:</strong> " + tipoSeleccionado;

            let sintomas = document.createElement("p");
            sintomas.innerHTML = "<strong>Síntomas:</strong> " + document.getElementById("sinto").value;

            let modificar = document.createElement("button");
            modificar.innerHTML = "✍️"
            modificar.id = "BT1"
            modificar.className = "bot"
            modificar.setAttribute("data-tarjeta-id", "tarjeta-" + i);
            modificar.setAttribute("data-indice", i);
            /*  modificar.addEventListener("click", function () {
                 let indice = parseInt(modificar.getAttribute("data-indice"));
                 indiceTarjetaModificada = indice;
                 mostrarModalModificar(indice);
             }); */

            modificar.setAttribute("data-bs-toggle", "modal");
            modificar.setAttribute("data-bs-target", "#exampleModal");
            modificar.addEventListener("click", function (event) {
                editarCita(event);
            });

            let guardar = document.getElementById("boto");
            if (indiceTarjetaModificada === -1) {
                guardar.onclick = function () {
                    if (validar()) {
                        crear();
                        limpiar();
                    }
                };
            } else {
                guardar.onclick = function () {
                    if (validar()) {
                        actualizar(indiceTarjetaModificada);
                        limpiar();
                        indiceTarjetaModificada = -1;
                    }
                };
            }
            function editarCita(event) {
                let tarjeta = event.target.closest(".card");

                let nombreMascota = tarjeta.querySelector("h2").textContent;
                let propietario = tarjeta.querySelector("p:nth-child(3)").textContent.replace("Propietario: ", "");
                let telefono = tarjeta.querySelector("p:nth-child(4)").textContent.replace("Teléfono: ", "");
                let fecha = tarjeta.querySelector("p:nth-child(5)").textContent.replace("Fecha: ", "");
                let hora = tarjeta.querySelector("p:nth-child(6)").textContent.replace("Hora: ", "");
                let animal = tarjeta.querySelector("p:nth-child(7)").textContent.replace("Animal: ", "");
                let sintomas = tarjeta.querySelector("p:nth-child(8)").textContent.replace("Síntomas: ", "");

                document.getElementById("nombre").value = nombreMascota;
                document.getElementById("propietario").value = propietario;
                document.getElementById("telefono").value = telefono;
                document.getElementById("fecha").value = fecha;
                document.getElementById("hora").value = hora;
                document.getElementById("tipo").value = animal;
                document.getElementById("sinto").value = sintomas;

                citaModificadaIndex = Array.from(tarjeta.parentNode.children).indexOf(tarjeta);
            }

            let eliminar = document.createElement("button");
            eliminar.innerHTML = " ❌"
            eliminar.id = "BT2"
            eliminar.className = "bot"
            eliminar.addEventListener("click", function () {
                eliminarTarjeta(eliminar.getAttribute("data-tarjeta-id"));
            });
            eliminar.setAttribute("data-bs-toggle", "modal");
            eliminar.setAttribute("data-bs-target", "#confirmModal");
            eliminar.setAttribute("data-tarjeta-id", "tarjeta-" + i);
            eliminar.setAttribute("data-id", "tarjeta-" + i);
            card.appendChild(imagen);
            card.appendChild(nombre);
            card.appendChild(propietario);
            card.appendChild(telefono);
            card.appendChild(fecha);
            card.appendChild(hora);
            card.appendChild(tipoSeleccionadoElement);
            card.appendChild(sintomas);
            card.appendChild(modificar);
            card.appendChild(eliminar);
            cardsContainer.appendChild(card);
        }

    }

    function limpiar() {
        document.getElementById("nombre").value = "";
        document.getElementById("propietario").value = "";
        document.getElementById("telefono").value = "";
        document.getElementById("tipo").value = "";
        document.getElementById("fecha").value = "";
        document.getElementById("hora").value = "";
        document.getElementById("sinto").value = "";
    }


    function eliminarTarjeta(tarjetaId) {
        let tarjeta = document.getElementById(tarjetaId);
        if (tarjeta) {
            tarjeta.remove();
        }
    }
    /* let tarjetaSeleccionada = null;
    let indiceTarjetaSeleccionada = -1;

    function mostrarModalModificar(tarjetaId) {
        let guardar = document.getElementById("boto");
        guardar.setAttribute("onclick", "guardarModificacion()");
        let tarjeta = document.getElementById(tarjetaId);
        if (tarjeta) {
            let imagen = tarjeta.querySelector("img");
            let nombre = tarjeta.querySelector("h2");
            let propietario = tarjeta.querySelector("p:nth-of-type(1)");
            let telefono = tarjeta.querySelector("p:nth-of-type(2)");
            let fecha = tarjeta.querySelector("p:nth-of-type(3)");
            let hora = tarjeta.querySelector("p:nth-of-type(4)");
            let tipo = tarjeta.querySelector("p:nth-of-type(5)");
            let sintomas = tarjeta.querySelector("p:nth-of-type(6)");

            if (nombre && propietario && telefono && fecha && hora && tipo && sintomas) {
                document.getElementById("nombre").value = nombre.textContent;
                document.getElementById("propietario").value = propietario.textContent.replace("Propietario: ", "");
                document.getElementById("telefono").value = telefono.textContent.replace("Teléfono: ", "");
                document.getElementById("tipo").value = tipo.textContent.replace("Tipo: ", "");
                document.getElementById("fecha").value = fecha.textContent.replace("Fecha: ", "");
                document.getElementById("hora").value = hora.textContent.replace("Hora: ", "");
                document.getElementById("sinto").value = sintomas.textContent.replace("Síntomas: ", "");

                let modal = new bootstrap.Modal(document.getElementById("exampleModal"));
                modal.show();
            } else {
                console.error("No se encontraron los elementos necesarios en la tarjeta.");
            }
        } else {
            console.error("No se encontró la tarjeta con el ID: " + tarjetaId);
        }
    } */
    /*  function guardarModificacion() {
         if (validar()) {
             if (indiceTarjetaModificada === -1) {
                 crear();
                 limpiar();
             } else {
                 actualizar(indiceTarjetaModificada);
                 limpiar();
                 indiceTarjetaModificada = -1;
             }
         }
     } */





    /* function mostrarModalModificar(tarjetaId) {
        let tarjeta = document.getElementById(tarjetaId);
        if (tarjeta) {
            let nombre = tarjeta.querySelector("h2").textContent;
            let propietario = tarjeta.querySelector("p:nth-child(2)").textContent.replace("propietario: ", "");
            let telefono = tarjeta.querySelector("p:nth-child(3)").textContent.replace("teléfono: ", "");
            let tipo = tarjeta.querySelector("p:nth-child(6)").textContent.replace("tipo: ", "");
            let fecha = tarjeta.querySelector("p:nth-child(4)").textContent.replace("fecha: ", "");
            let hora = tarjeta.querySelector("p:nth-child(5)").textContent.replace("hora: ", "");
            let sintomas = tarjeta.querySelector("p:nth-child(8)").textContent.replace("sinto: ", "");

            document.getElementById("nombre").value = nombre;
            document.getElementById("propietario").value = propietario;
            document.getElementById("telefono").value = telefono;
            document.getElementById("tipo").value = tipo;
            document.getElementById("fecha").value = fecha;
            document.getElementById("hora").value = hora;
            document.getElementById("sinto").value = sintomas;

            // Mostrar el modal
            let modal = new bootstrap.Modal(document.getElementById("exampleModal"));
            modal.show();
        }
    } */

    /* function actualizar(indice) {
        let tarjetaModificada = document.querySelector("#tarjetas #tarjeta-" + indice);

        if (tarjetaModificada) {
            let imagen = tarjetaModificada.querySelector("img");
            let nombre = tarjetaModificada.querySelector("h2");
            let propietario = tarjetaModificada.querySelector("p:nth-of-type(2)");
            let telefono = tarjetaModificada.querySelector("p:nth-of-type(3)");
            let fecha = tarjetaModificada.querySelector("p:nth-of-type(4)");
            let hora = tarjetaModificada.querySelector("p:nth-of-type(5)");
            let tipo = tarjetaModificada.querySelector("p:nth-of-type(6)");
            let sintomas = tarjetaModificada.querySelector("p:nth-of-type(8)");

            if (imagen && nombre && propietario && telefono && fecha && hora && tipo && sintomas) {
                let tipoSeleccionado = document.getElementById("tipo").value;
                if (tipoSeleccionado === "Opcion 1") {
                    imagen.src = mascotas[0].gato;
                } else if (tipoSeleccionado === "Opcion 2") {
                    imagen.src = mascotas[0].perro;
                } else if (tipoSeleccionado === "Opcion 3") {
                    imagen.src = mascotas[0].ave;
                } else if (tipoSeleccionado === "Opcion 4") {
                    imagen.src = mascotas[0].pez;
                } else if (tipoSeleccionado === "Opcion 5") {
                    imagen.src = mascotas[0].reptil;
                }
                guardarModificacion()
                nombre.textContent = document.getElementById("nombre").value;
                propietario.innerHTML = "<strong>Propietario:</strong> " + document.getElementById("propietario").value;
                telefono.innerHTML = "<strong>Teléfono:</strong> " + document.getElementById("telefono").value;
                fecha.innerHTML = "<strong>Fecha:</strong> " + document.getElementById("fecha").value;
                hora.innerHTML = "<strong>Hora:</strong> " + document.getElementById("hora").value;
                tipo.innerHTML = "<strong>Tipo:</strong> " + tipoSeleccionado;
                sintomas.innerHTML = "<strong>Síntomas:</strong> " + document.getElementById("sinto").value;
            }
        } else {
            console.error("No se encontró la tarjeta con el ID: tarjeta-" + indice);
        }
    } */




    function validar() {

        let validacion = true;
        let hora = document.getElementById("hora").value;
        let Hmi = new Date();
        Hmi.setHours(6, 0, 0); // Establece la hora mínima a las 6 am

        let Hma = new Date();
        Hma.setHours(18, 0, 0); // Establece la hora máxima a las 6 pm

        let Hsel = new Date();

        Hsel.setHours(parseInt(hora.split(":")[0]), parseInt(hora.split(":")[1]), 0);



        let fecha = new Date(document.getElementById("fecha").value.trim());

        let FA = new Date();

        // Obtiene el día de la semana (domingo: 0, lunes: 1, ..., sábado: 6)
        let DS = fecha.getDay();

        // Obtiene el día actual
        let DA = new Date().getDay();
        if (document.getElementById("nombre").value.trim() === "") {

            setTimeout(function () {
                Alerta.innerHTML = "Por favor digite un nombre";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red"
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000)
            });
            validacion = false;
        }

        else if (document.getElementById("propietario").value.trim() === "") {
            setTimeout(function () {
                Alerta.innerHTML = "Por favor digite el propieatario";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red"
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000)
            });

            validacion = false;
        }

        else if (document.getElementById("telefono").value.trim() === "") {

            setTimeout(function () {
                Alerta.innerHTML = "Por favor digite numero de telefono";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red"
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000)
            });

            validacion = false;
        }
        else if (document.getElementById("telefono").value.trim().length !== 10) {

            setTimeout(function () {
                Alerta.innerHTML = "Por favor digite 10 numeros para el numero de telefono";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red"
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000)
            });

            validacion = false;
        }

        else if (document.getElementById("tipo").value.trim() === "") {

            setTimeout(function () {
                Alerta.innerHTML = "Por favor digite el tipo de mascota";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red"
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000)

            });
            validacion = false;
        } else if (document.getElementById("fecha").value.trim() === "") {

            setTimeout(function () {
                Alerta.innerHTML = "Por favor digite la fecha";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red"
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000)

            });
            validacion = false;
        }
        /*  else if (fecha.toDateString() === FA.toDateString()) {
             setTimeout(function () {
                 Alerta.innerHTML = "Por favor selecciona una fecha diferente a la actual";
                 Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                 Alerta.style.fontSize = "20px";
                 Alerta.style.textAlign = "center";
                 Alerta.style.width = "100%";
                 Alerta.style.padding = "20px";
                 Alerta.style.margin = "0";
                 Alerta.style.border = "3px solid red";
                 setTimeout(function () {
                     Alerta.innerHTML = "";
                     Alerta.style = "";
                 }, 2000);
             });
             validacion = false;
         } */
        else if (new Date(fecha) <= FA || DS === 5 || DS === 6 || DS === FA) {
            setTimeout(function () {
                Alerta.innerHTML = "Por favor seleccione una fecha válida";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red";
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000);
            });
            validacion = false;
        }
        /* else if (DS === 0 || DS === 6) {
            setTimeout(function () {
                Alerta.innerHTML = "Por favor selecciona una fecha válida (no sábado ni domingo)";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red";
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000);
            });
            validacion = false;
        } 
 */

        else if (document.getElementById("hora").value.trim() === "") {

            setTimeout(function () {
                Alerta.innerHTML = "Por favor digite la hora";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red"
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000)

            });
            validacion = false;
        }
        else if (Hsel < Hmi || Hsel > Hma) {
            setTimeout(function () {
                Alerta.innerHTML = "Por favor seleccione una hora válida";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red";
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000);
            });
            validacion = false;
        }
        else if (document.getElementById("sinto").value.trim() === "") {

            setTimeout(function () {
                Alerta.innerHTML = "Por favor digite los sintomas";
                Alerta.style.backgroundColor = "rgb(255, 163, 163)";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid red"

                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000)

            });
            validacion = false;
        }
        else {

            setTimeout(function () {
                Alerta.innerHTML = "Cita creada exitosamente";
                Alerta.style.backgroundColor = "#66FF66";
                Alerta.style.fontSize = "20px";
                Alerta.style.textAlign = "center";
                Alerta.style.width = "100%";
                Alerta.style.padding = "20px";
                Alerta.style.margin = "0";
                Alerta.style.border = "3px solid green"
                setTimeout(function () {
                    Alerta.innerHTML = "";
                    Alerta.style = "";
                }, 2000);

            });

        }
        return validacion;
    }




</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
    crossorigin="anonymous"></script>
</html>